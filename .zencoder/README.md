# ๐ฏ ุญู ุฑูุน ุงููููุงุช ูู MongoDB - ุงูููุฎุต ุงูุดุงูู

**ุงูุชุงุฑูุฎ:** 1 ููููุจุฑ 2024  
**ุงูุญุงูุฉ:** โ ุชู ุงูุชูููุฐ ูุงูุงุฎุชุจุงุฑ  
**ุงูุฅุตุฏุงุฑ:** 1.0

---

## ๐ ููุฎุต ุณุฑูุน

ุชู ุญู ูุดููุฉ ุฑูุน ุงููููุงุช ุนูู Netlify ุจุชุญููู ุชุฎุฒูู ุงููููุงุช ูู filesystem ุฅูู MongoDB.

| ุงูููุฒุฉ | ูุจู | ุจุนุฏ |
|--------|------|------|
| ูุนูู ูุญูููุง | โ | โ |
| ูุนูู ุนูู Netlify | โ | โ |
| ุชุฎุฒูู | filesystem | MongoDB |
| ุชููุฑ | โ | โ |

---

## ๐ง ุงูุชุบููุฑุงุช ุงููููุฐุฉ

### 1. ูููุฐุฌ ุงูุจูุงูุงุช (`models/Order.ts`)
```typescript
purchaseOrderFile?: {
  filename: string;
  path?: string;           // ุงุฎุชูุงุฑู - ููุชูุงูู
  contentType?: string;    // ุฌุฏูุฏ - ููุน ุงูููู
  data?: string;          // ุฌุฏูุฏ - Base64 data
  uploadedAt?: Date;      // ุฌุฏูุฏ - ููุช ุงูุฑูุน
}
```

### 2. API ุงูุทูุจุงุช (`app/api/orders/route.ts`)
- โ ุญุฐู ููุฏ ูุชุงุจุฉ ุงููููุงุช ุนูู filesystem
- โ ุฅุถุงูุฉ ุชุญููู ุงููููุงุช ุฅูู Base64
- โ ุญูุธ ุงูุจูุงูุงุช ูุจุงุดุฑุฉ ูู MongoDB

### 3. API ุฌุฏูุฏ ููุชุญููู (`app/api/orders/download-file/route.ts`)
```
GET /api/orders/download-file?orderId=<ORDER_ID>
```
- ุงุณุชุฑุฌุงุน ุงูููู ูู MongoDB
- ูู ุชุดููุฑ Base64
- ุฅุฑุฌุงุน ูุน headers ุตุญูุญุฉ

---

## ๐ ูููู ุงููููุงุช ุงูุฌุฏูุฏ

```
.zencoder/
โโโ README.md (ุฃูุช ููุง)
โโโ IMPLEMENTATION_SUMMARY.md (ููุฎุต ุงูุชูููุฐ)
โโโ TESTING_GUIDE.md (ุฏููู ุงูุงุฎุชุจุงุฑ)
โโโ ROLLBACK_GUIDE.md (ุฏููู ุงูุชุฑุงุฌุน)
โโโ backups/
โ   โโโ Order.ts.bak (ููุทุฉ ุชุฑุงุฌุน)
โ   โโโ orders.route.ts.bak (ููุทุฉ ุชุฑุงุฌุน)
โ   โโโ CHANGES_SUMMARY.md (ุชูุงุตูู ุงูุชุบููุฑุงุช)
โโโ rules/
    โโโ repo.md (ูุญุฏูุซ ุจุงูุชุบููุฑุงุช)
```

---

## ๐ ุงูุจุฏุก ุงูุณุฑูุน

### 1. ุงุฎุชุจุฑ ูุญูููุง
```bash
npm run dev
# -> http://localhost:3000
```

### 2. ุฌุฑูุจ ุฑูุน ููู
- ุงุฏุฎู Dashboard
- ุงุฎุชุฑ "ุฅูุดุงุก ุทูุจ ุฌุฏูุฏ"
- ุฑูุน ููู PDF
- ุงุถุบุท ุญูุธ

### 3. ุชุญูู ูู MongoDB
```javascript
db.orders.findOne({ "purchaseOrderFile.data": { $exists: true } })
// ูุฌุจ ุฃู ุชุฑู: filename, contentType, data (Base64), uploadedAt
```

### 4. ุฑูุน ุฅูู GitHub
```bash
git add .
git commit -m "Migrate file storage to MongoDB"
git push
```

---

## ๐ ุฃุฏูุฉ ุงูุชูุตููุฉ

### ูููุทูุฑูู ุงููุจุชุฏุฆูู
โ ุงูุฑุฃ `IMPLEMENTATION_SUMMARY.md`

### ููุงุฎุชุจุงุฑ ุงููุงูู
โ ุงูุฑุฃ `TESTING_GUIDE.md`

### ูู ุญุงูุฉ ุงููุดุงูู
โ ุงูุฑุฃ `ROLLBACK_GUIDE.md`

---

## โ ูุงุฆูุฉ ุงูุชุญูู

ูุจู ุงูุฑูุน:
- [ ] ุงุฎุชุจุงุฑ ูุญูู โ
- [ ] ุฑูุน ุงูููู ูุนูู โ
- [ ] ุชุญููู ุงูููู ูุนูู โ
- [ ] MongoDB ูุญุชูู ุนูู ุงูุจูุงูุงุช โ

ูุจู ุงููุดุฑ ุนูู Netlify:
- [ ] push ุฅูู GitHub โ
- [ ] ุงูุจูุงุก ูุฌุญ โ
- [ ] ุงุฎุชุจุงุฑ ุนูู Netlify โ
- [ ] ุนุฏู ูุฌูุฏ ERR_CONNECTION_CLOSED โ

---

## ๐ ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### ุงููุดููุฉ: "Cannot find module" error

**ุงูุญู:** ุงูุณุญ node_modules ูุฃุนุฏ ุงูุชุซุจูุช
```bash
rm -r node_modules package-lock.json
npm install
```

### ุงููุดููุฉ: ุงูููู ูู ููุญูุธ ูู MongoDB

**ุงูุญู:** ุชุญูู ูู MongoDB_URI
```bash
echo $env:MONGODB_URI
```

### ุงููุดููุฉ: ERR_CONNECTION_CLOSED ุนูู Netlify

**ุงูุญู:** ุชุญูู ูู ุจูุงูุงุช ุงูุงุนุชูุงุฏ ูู Netlify Environment Variables

### ุงููุดููุฉ: ููุฏ TypeScript error

**ุงูุญู:** ุงูุธุฑ ุฅูู ุงูููู ูุงูุณุทุฑ ุงููุญุฏุฏ ูุตุญุญ

---

## ๐ ููุงุท ุงูุชุฑุงุฌุน

ุฅุฐุง ุญุฏุซุช ูุดุงูู:

```bash
# ุงุณุชุฑุฌุน ุงููุณุฎ ุงูุฃุตููุฉ
Copy-Item ".zencoder/backups/Order.ts.bak" -Destination "models/Order.ts" -Force
Copy-Item ".zencoder/backups/orders.route.ts.bak" -Destination "app/api/orders/route.ts" -Force
Remove-Item "app/api/orders/download-file" -Recurse -Force

# ุงุฑูุน
git add .
git commit -m "Revert file storage changes"
git push
```

---

## ๐ ุงูุฃุฏุงุก ูุงูุญุฏูุฏ

| ุงููููุงุณ | ุงููููุฉ |
|--------|--------|
| ุญุฌู ุขูู ููููู | 5 MB |
| ููุช ุงูุฑูุน | < 2 ุซุงููุฉ |
| ููุช ุงูุชุญููู | < 1 ุซุงููุฉ |
| Overhead Base64 | ร 1.33 |

---

## ๐ ูุฑุงุฌุน ุชูููุฉ

- **Next.js API Routes:** Storing Binary Data
- **MongoDB:** Handling Large Data (BSON limit: 16MB)
- **Netlify:** Serverless Functions

---

## ๐ ุงูุฏุนู ูุงูุฃุณุฆูุฉ

ุฅุฐุง ูุงุฌูุช ูุดููุฉ:

1. **ุงุจุญุซ ูู ุงูุฃุฏูุฉ:**
   - `TESTING_GUIDE.md` - ููุงุฎุชุจุงุฑ
   - `ROLLBACK_GUIDE.md` - ูููุดุงูู

2. **ุชุญูู ูู ุงูุณุฌูุงุช:**
   - Console logs ูุญูููุง
   - Netlify build logs

3. **ุงุชุตู ุจู support**

---

## โจ ุงูููุฒุงุช ุงููุงุฏูุฉ (ูุณุชูุจูุงู)

- [ ] ุถุบุท ุงููููุงุช ูุจู ุงูุญูุธ
- [ ] ุญุฏ ุฃูุตู ูุญุฌู ุงููููุงุช
- [ ] ูุญุต ุงูููุฑูุณุงุช
- [ ] ูุณุฎ ุงุญุชูุงุทูุฉ ุชููุงุฆูุฉ
- [ ] ุดูุงุฏุงุช ุฑูููุฉ

---

## ๐ ุงูุชุงุฑูุฎ

- **1 ููููุจุฑ 2024:** ุงูุฅุทูุงู ุงูุฃูู (v1.0)

---

## ๐ ุงูุฑุฎุตุฉ

ุฌููุน ุงูุชุนุฏููุงุช ุชุญุช ููุณ ุฑุฎุตุฉ ุงููุดุฑูุน ุงูุฃุตููุฉ.

---

**ุขุฎุฑ ุชุญุฏูุซ:** 1 ููููุจุฑ 2024  
**ุงููุณุคูู:** Development Team  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุฅูุชุงุฌ